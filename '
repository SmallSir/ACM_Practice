#include<cstdio>
#include<cmath>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#include <cstdlib>
#include <map>
using namespace std;
int vis[200];
int n;
char a[30], s[100010], b[100010];
int main() {
	scanf("%s", a);
	int t = strlen(a);
	for(int i = 0; i < t; i++)vis[a[i]] = 1;
	scanf("%s", s);
	int m = strlen(s);
	scanf("%d", &n);
	for(int i = 1; i <= n; i++){
		scanf("%s", b);
		int l = strlen(b), pos_l = 0, pos_r = m - 1;;
		int flag = l;
		int ok = 0;
		for(int j = 0; j < l; j++){
			if(s[pos_l] == b[j])pos_l++;
			else {
				if(s[pos_l] == '?'){
					if(vis[b[j]])pos_l++;
					else{
						ok = 1;
						printf("NO\n");
						break;
					}
				}
				else if(s[pos_l] != '*'){
					ok = 1;
					printf("NO\n");
					break;
				}
				else if(s[pos_l] == '*'){
					flag = j;
					break;
				}
			}
		}
		for(int j = l - 1; j >= flag; j--){
			if(s[pos_r] == b[j])pos_r--;
			else{
				if(s[pos_r] == '?'){
					if(vis[b[j]])pos_r--;
					else{
						ok = 1;
						printf("NO\n");
						break;
					}
				}
				else if(s[pos_r] != '*'){
					ok = 1;
					printf("NO\n");
					break;
				}
				else{
					if(vis[b[j]]){
						ok = 1;
						printf("NO\n");
						break;
					}
				}
			}
		}
		if(!ok) {
			for(int j = pos_l; j <= pos_r; j++)
				if(s[j] != '*'){
					ok = 1;
					printf("NO\n");
					break;
				}
		}
		if(!ok) printf("YES\n");
	}
}
